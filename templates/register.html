<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inscription — Baby-Foot Club</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='responsive-mobile.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='style-extended.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='global-animations.css') }}">
  <script src="{{ url_for('static', filename='global-animations.js') }}" defer></script>
</head>
<body>
<div class="auth-wrap">
  <div class="auth-box">
    <div class="auth-logo">
      <img src="{{ url_for('static', filename='images/logo.svg') }}" alt="">
      <span>Baby-Foot Club</span>
    </div>
    <h1 class="auth-title">Créer un compte</h1>
    <p class="auth-sub">Rejoignez le club et suivez vos scores</p>

    <div class="auth-form">
      <div id="alert" class="alert"></div>
      <div class="field">
        <label class="label">Nom d'utilisateur</label>
        <input type="text" id="username" placeholder="pseudo_unique" autocomplete="username" autofocus>
        <div style="font-size:0.8125rem;color:var(--text-tertiary);margin-top:0.5rem">3–20 caractères · lettres, chiffres, - et _</div>
      </div>
      <div class="field">
        <label class="label">Mot de passe</label>
        <input type="password" id="password" placeholder="Minimum 6 caractères" autocomplete="new-password">
      </div>
      <button class="auth-submit" id="regBtn">Créer mon compte</button>
    </div>

    <div class="auth-sep">ou</div>
    <div class="auth-switch">Déjà un compte ? <a href="/login">Se connecter</a></div>
  </div>
</div>
<script>
  function showAlert(msg, type) {
    const el = document.getElementById('alert');
    el.textContent = msg; el.className = 'alert '+type; el.style.display = 'block';
  }
  async function register() {
    const u = document.getElementById('username').value.trim();
    const p = document.getElementById('password').value;
    const btn = document.getElementById('regBtn');
    if (!u || !p) { showAlert('Veuillez remplir tous les champs', 'error'); return; }
    if (p.length < 6) { showAlert('Mot de passe trop court (min 6)', 'error'); return; }
    btn.disabled = true;
    btn.innerHTML = '<span class="spin"></span>';
    try {
      const r = await fetch('/api/register', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({username:u, password:p}) });
      const d = await r.json();
      if (d.success) { showAlert('Compte créé !', 'success'); setTimeout(()=>window.location.href='/dashboard', 700); }
      else { showAlert(d.message||"Erreur d'inscription", 'error'); btn.disabled=false; btn.textContent='Créer mon compte'; }
    } catch(e) { showAlert('Erreur serveur', 'error'); btn.disabled=false; btn.textContent='Créer mon compte'; }
  }
  document.getElementById('regBtn').addEventListener('click', register);
  document.getElementById('password').addEventListener('keydown', e=>{ if(e.key==='Enter') register(); });
</script>
</body>
</html>
